    </head>
    <body>
        <div id="main">
          <div id="area"></div>
        </div>

        <script>

            var rendered = book.renderTo("area");

            book.ready.all.then(function(){
              // Load in stored locations from json or local storage
              var stored = localStorage.getItem(key);
              if (stored) {
                return book.locations.load(stored);
              } else {
                // Or generate the locations on the fly
                // Can pass an option number of chars to break sections by
                // default is 150 chars
                return book.locations.generate(1600);
              }
            })
            .then(function(locations){
                controls.style.display = "block";
                slider.setAttribute("type", "range");
                slider.setAttribute("min", 0);
                slider.setAttribute("max", 100);
                // slider.setAttribute("max", book.locations.total+1);
                slider.setAttribute("step", 1);
                slider.setAttribute("value", 0);
                slider.addEventListener("change", slide, false);
                slider.addEventListener("mousedown", function(){
                    mouseDown = true;
                }, false);
                slider.addEventListener("mouseup", function(){
                    mouseDown = false;
                }, false);
                // Wait for book to be rendered to get current page
                rendered.then(function(){
                    // Get the current CFI
                    var currentLocation = book.getCurrentLocationCfi();
                    // Get the Percentage (or location) from that CFI
                    var currentPage = book.locations.percentageFromCfi(currentLocation);
                    slider.value = currentPage;
                    currentPage.value = currentPage;
                });
                controls.appendChild(slider);
                currentPage.addEventListener("change", function(){
                  var cfi = book.locations.cfiFromPercentage(currentPage.value/100);
                  book.gotoCfi(cfi);
                }, false);
                // Listen for location changed event, get percentage from CFI
                book.on('renderer:locationChanged', function(location){
                    Android.saveCurrentPageData(locationCfi);
                    Android.setUIPageData(book.pagination.pageFromCfi(locationCfi),book.pagination.lastPage);

                    var percent = book.locations.percentageFromCfi(location);
                    var percentage = Math.floor(percent * 100);
                    currentPage.value = percentage;
                });
                // Save out the generated locations to JSON
                localStorage.setItem(book.settings.bookKey+'-locations', book.locations.save());				
            });

            var setWidthAndHeight = function(pwidth,pheight,pdevicewidth,pdeviceheight){
                book.setStyle("width",""+pwidth);
                book.setStyle("height",""+pheight);

                var widthPercent = (pwidth / pdevicewidth)*100;
                var heightPercent = (pheight / pdeviceheight)*100;

                book.setStyle("margin",(100-heightPercent)+"% "+(100-widthPercent)+"%");
            }
        </script>
    </body>
</html>